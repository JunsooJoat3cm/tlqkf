<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê°€ìƒ ë„ë°• ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        background: #111;
        color: #0f0;
        font-family: 'Courier New', monospace;
        margin: 0;
        display: flex;
        height: 100vh;
        flex-direction: row; /* í™”ë©´ì„ ì¢Œìš°ë¡œ ë‚˜ëˆ” */
      }
      .left-panel {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        width: 50%; /* ì¢Œì¸¡ ì˜ì—­ì€ í™”ë©´ì˜ 50% ì°¨ì§€ */
        padding: 20px;
        overflow-y: auto;
      }
      .right-panel {
        width: 50%; /* ìš°ì¸¡ ì˜ì—­ì€ í™”ë©´ì˜ 50% ì°¨ì§€ */
        display: flex;
        justify-content: flex-end;
        align-items: flex-start;
        padding: 20px;
      }
      input,
      button {
        font-size: 18px;
        padding: 10px 15px;
        background: #000;
        color: #0f0;
        border: 2px solid #0f0;
        margin: 6px;
        width: 100%;
      }
      #log {
        margin-top: 20px;
        white-space: pre-wrap;
        max-height: 200px;
        overflow-y: auto;
        font-size: 20px;
      }
      .highlight {
        color: #ff0;
        font-size: 24px;
        animation: flash 0.3s ease-in-out;
      }
      @keyframes flash {
        0% {
          transform: scale(1.2);
          color: #0f0;
        }
        50% {
          transform: scale(1.4);
          color: #f00;
        }
        100% {
          transform: scale(1.2);
          color: #ff0;
        }
      }
      #resetBtn,
      #gameOverScreen,
      #titleSettings {
        display: none;
      }
      #settingsToggle {
        font-size: 24px;
        background: transparent;
        border: none;
        color: #0f0;
        cursor: pointer;
        position: fixed;
        top: 10px;
        left: 10px; /* ì¢Œì¸¡ ìƒë‹¨ìœ¼ë¡œ ë°°ì¹˜ */
        z-index: 1000;
      }
      #gameOverScreen {
        margin-top: 30px;
        font-size: 20px;
        color: #f00;
      }
      #slogan {
        margin-top: 20px;
        font-style: italic;
        color: #ff0;
      }
      #chartContainer {
        width: 90%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <button
      id="settingsToggle"
      onclick="toggleTitleSettings()"
      aria-label="ì„¤ì • ì—´ê¸°"
    >
      âš™ï¸
    </button>

    <div class="left-panel">
      <h2>ğŸ’° ë³´ìœ  ê¸ˆì•¡: <span id="money">1000</span> ë§Œì›</h2>

      <input
        type="number"
        id="bet"
        placeholder="ë² íŒ… ê¸ˆì•¡ ì…ë ¥ (ë§Œì› ë‹¨ìœ„)"
        min="1"
        aria-label="ë² íŒ… ê¸ˆì•¡ ì…ë ¥"
      />
      <button id="gambleBtn" aria-label="ë² íŒ… ì‹œì‘">ë² íŒ…</button>
      <button id="resetBtn" onclick="resetGame()" aria-label="ê²Œì„ ì´ˆê¸°í™”">
        ë‹¤ì‹œ ì‹œì‘
      </button>

      <div id="log"></div>

      <div id="gameOverScreen">
        <div id="finalMessage"></div>
        <div id="slogan"></div>
        <div>ğŸ“ˆ ê²Œì„ ì¤‘ ìµœëŒ€ ë³´ìœ  ê¸ˆì•¡: <span id="maxMoney"></span> ë§Œì›</div>
        <button onclick="resetGame()" aria-label="ë‹¤ì‹œ ì‹œì‘">ë‹¤ì‹œ ì‹œì‘</button>
      </div>
    </div>

    <div class="right-panel">
      <div id="chartContainer">
        <canvas id="moneyChart"></canvas>
      </div>
    </div>

    <div id="titleSettings">
      <input
        type="text"
        id="titleInput"
        placeholder="íƒ­ ì œëª© ë³€ê²½"
        aria-label="íƒ­ ì œëª© ì…ë ¥"
      />
      <button onclick="changeTitle()" aria-label="íƒ­ ì œëª© ë³€ê²½">ë³€ê²½</button>
    </div>

    <script>
      let money = 1000;
      let maxMoney = 1000;
      const slogans = [
        'ë„ë°•ì€ ì¤‘ë…ì…ë‹ˆë‹¤. ì‹œì‘ì€ ì¬ë¯¸, ëì€ íŒŒë©¸.',
        'í•œíƒ•ì˜ ìœ í˜¹, ì¸ìƒì„ ìƒëŠ” ì§€ë¦„ê¸¸.',
        'ë”¸ ë•ŒëŠ” ìš´, ìƒì„ ë•ŒëŠ” ì „ì¬ì‚°.',
        'ì¤‘ë…ì€ ì¹˜ë£Œë³´ë‹¤ ì˜ˆë°©ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.',
        'í•œë°©ì„ ë…¸ë¦¬ë‹¤ ëª¨ë“  ê²ƒì„ ìƒëŠ”ë‹¤.',
        'ë„ë°•ì€ ìš´ì´ ì•„ë‹Œ ì†í•´ ê³„ì‚°ì…ë‹ˆë‹¤.',
      ];

      const moneyEl = document.getElementById('money');
      const logEl = document.getElementById('log');
      const resetBtn = document.getElementById('resetBtn');
      const betInput = document.getElementById('bet');
      const gambleBtn = document.getElementById('gambleBtn');
      const titleInput = document.getElementById('titleInput');
      const gameOverScreen = document.getElementById('gameOverScreen');
      const finalMessage = document.getElementById('finalMessage');
      const slogan = document.getElementById('slogan');
      const maxMoneyEl = document.getElementById('maxMoney');

      const chartCtx = document.getElementById('moneyChart').getContext('2d');
      const chartData = {
        labels: ['Start'],
        datasets: [
          {
            label: 'ë³´ìœ  ê¸ˆì•¡ ì¶”ì´',
            data: [1000],
            borderColor: '#0f0',
            backgroundColor: 'transparent',
            tension: 0.2,
          },
        ],
      };
      const moneyChart = new Chart(chartCtx, {
        type: 'line',
        data: chartData,
        options: {
          scales: {
            y: {
              beginAtZero: true,
            },
          },
        },
      });

      function gamble() {
        if (money <= 0 || betInput.disabled) return;
        const bet = parseInt(betInput.value);
        if (!isValidBet(bet)) return;

        const prevMoney = money;
        const result = generateGambleResult(bet);
        updateGameState(result);

        maxMoney = Math.max(maxMoney, money);

        if (money !== prevMoney) {
          chartData.labels.push('');
          chartData.datasets[0].data.push(money);
          moneyChart.update();
        }

        if (money <= 0 || result.includes('ğŸš” êµ¬ì†ë¨')) {
          showGameOver(result);
        }
      }

      function isValidBet(bet) {
        if (isNaN(bet) || bet <= 0) {
          log('ì˜¬ë°”ë¥¸ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.');
          return false;
        }
        if (bet > money) {
          log('ë² íŒ… ê¸ˆì•¡ì´ ë³´ìœ  ê¸ˆì•¡ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤!');
          return false;
        }
        return true;
      }

      function generateGambleResult(bet) {
        const r = Math.random();
        if (r < 0.4) {
          money -= bet;
          return `ğŸ˜¢ ì‹¤íŒ¨! ${bet}ë§Œì› ì†ì‹¤.`;
        } else if (r < 0.8) {
          const win = bet * 2;
          money += win;
          return `ğŸ‰ ì„±ê³µ! ${win}ë§Œì› íšë“!`;
        } else if (r < 0.9) {
          const fine = Math.floor(money * 0.1);
          money -= bet + fine;
          return `ğŸ’¸ ë²Œê¸ˆ! ${bet}ë§Œì› ì†ì‹¤ + ${fine}ë§Œì› ë²Œê¸ˆ.`;
        } else if (r < 0.95) {
          const jackpot = bet * 5;
          money += jackpot;
          return `ğŸ’¥ ì­íŒŸ! ${jackpot}ë§Œì› íšë“!!!`;
        } else {
          return 'ğŸš” êµ¬ì†ë¨! ê²½ì°°ì— ë¶™ì¡í˜”ìŠµë‹ˆë‹¤. ê²Œì„ ì˜¤ë²„!';
        }
      }

      function updateGameState(result) {
        moneyEl.textContent = money;
        log(`<span class="highlight">${result}</span>`);
      }

      function showGameOver(msg) {
        document.querySelector('input').disabled = true;
        betInput.disabled = true;
        gambleBtn.disabled = true;
        logEl.style.display = 'none';
        finalMessage.innerHTML = `<span class="highlight">${msg}</span>`;
        slogan.textContent =
          slogans[Math.floor(Math.random() * slogans.length)];
        maxMoneyEl.textContent = maxMoney;
        gameOverScreen.style.display = 'block';
      }

      function resetGame() {
        money = 1000;
        maxMoney = 1000;
        moneyEl.textContent = money;
        logEl.textContent = '';
        betInput.value = '';
        betInput.disabled = false;
        gambleBtn.disabled = false;
        gameOverScreen.style.display = 'none';
        logEl.style.display = 'block';
        chartData.labels = ['Start'];
        chartData.datasets[0].data = [1000];
        moneyChart.update();
      }

      function log(msg) {
        logEl.insertAdjacentHTML('afterbegin', `${msg}<br>`);
      }

      function changeTitle() {
        const newTitle = titleInput.value.trim();
        if (newTitle.length > 0) {
          document.title = newTitle;
          log(`íƒ­ ì œëª©ì´ '${newTitle}'(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }
      }

      function toggleTitleSettings() {
        const settings = document.getElementById('titleSettings');
        settings.style.display =
          settings.style.display === 'none' ? 'block' : 'none';
      }

      window.addEventListener('DOMContentLoaded', () => {
        resetGame();
      });

      betInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !betInput.disabled) gamble();
      });

      titleInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') changeTitle();
      });

      gambleBtn.addEventListener('click', gamble);
    </script>
  </body>
</html>
